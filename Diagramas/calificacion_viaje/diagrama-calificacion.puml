@startuml diagrama-calificacion
!theme plain
title Caso de Uso - Parte 3: CalificaciÃ³n del Viaje

actor "Usuario" as U
participant "UserUI" as UI
participant "DriverController" as CC
participant "Trip" as V
participant "DriverRepository" as CR
participant "Driver" as CON

== Inicio del Proceso de CalificaciÃ³n ==
note over UI
  Viaje completado exitosamente
  Estado actual: COMPLETADO
end note

UI --> U: "â­ CALIFICA TU VIAJE"

== Obtener Datos del Conductor ==
UI -> V: getDriver()
V --> UI: driver
UI -> CON: getName()
CON --> UI: nombre del conductor

UI --> U: "Â¿CÃ³mo fue tu experiencia con [Conductor]?"

== El Usuario Elige su CalificaciÃ³n ==
note over U
  El usuario evalÃºa su experiencia
  y decide dar 5 estrellas
end note

U -> UI: Seleccionar "5 estrellas â­â­â­â­â­"

== Procesamiento de la CalificaciÃ³n ==
UI -> CC: rateDriver(trip, 5)
CC -> CC: validar calificaciÃ³n (5 estÃ¡ entre 1-5) âœ…
CC -> V: setRating(5)
' CC -> V: setStatus(RATED)

== Registro de la CalificaciÃ³n ==
CC -> CR: registerRating(driver, 5)

note right of CR
  La calificaciÃ³n se guarda
  para el historial del conductor 
  (opcional)
end note

CR -> CON: addRating(5)

/' \nðŸ“‹ Estado final: CALIFICADO '/
== ConfirmaciÃ³n del Sistema ==
UI --> U: "âœ… Â¡Gracias por tu calificaciÃ³n!\nCalificaciÃ³n enviada: â­â­â­â­â­"

== FinalizaciÃ³n Completa del Viaje ==
UI -> UI: mostrarResumenFinal() (aca se puede usar el controlador de viajes)

/' â€¢ Saldo final: $2200
\nâ€¢ Estado: CALIFICADO
 '/
UI --> U: "ðŸŽ‰ VIAJE COMPLETADO\nResumen del viaje:\nâ€¢ Usuario: Juan PÃ©rez\n\nâ€¢ Viaje exitoso: Centro â†’ Av. Corrientes\nâ€¢ Tu calificaciÃ³n: â­â­â­â­â­"

UI --> U: "âœ¨ Â¡Gracias por usar Uber! âœ¨"

note over U
  Viaje completado exitosamente:
  
  âœ… LlegÃ³ a su destino
  âœ… Pago procesado correctamente
  âœ… CalificaciÃ³n registrada
  âœ… Puede solicitar un nuevo viaje
end note

@enduml
